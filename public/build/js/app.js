const body=document.querySelector("body");function iniciarApp(){tabs(),goBack(),setButtons(),autocompletar()}function tabs(){const t=body.querySelectorAll(".menu_item"),e=window.location.pathname;t.forEach(t=>{const n=t.children[0],a=new URL(n.href).pathname;(e===a||"/index.php"===e&&"/"===a)&&t.classList.add("active")})}function goBack(){const t=body.querySelector(".boton_back");t&&t.addEventListener("click",t=>{window.history.back()})}document.addEventListener("DOMContentLoaded",(function(){iniciarApp()}));const setButtons=()=>{document.querySelectorAll("#delete").forEach(t=>{t.addEventListener("click",()=>{alerta(t,"delete")})})};function alerta(t,e){const n=t.getAttribute("data-view");let a=document.createElement("INPUT");a.setAttribute("type","hidden"),a.setAttribute("name","id");let o=document.createElement("INPUT");o.setAttribute("class","boton"),o.setAttribute("type","submit"),o.classList.add("pad1-4");let s="";"delete"===e&&(o.setAttribute("value","Eliminar"),o.classList.add("delete"),"usuario"===n&&(console.log(n),s=eliminarUsuario(t,a)),"producto"==n&&(s=eliminarProducto(t,a)),"cliente"==n&&(s=eliminarCliente(t,a)),"categoria"==n&&(s=eliminarCategoria(t,a)),"factura"==n&&console.log("eliminando de factura"));const d=createForm(a,o,s);document.querySelector("body").appendChild(d)}function createForm(t,e,n){const a=document.createElement("IMG");a.classList.add("form_image"),a.setAttribute("src","/build/img/message-solid.svg");const o=document.createElement("H2");o.classList.add("form_title"),o.textContent="¿Estas seguro?";const s=document.createElement("SPAN");s.classList.add("form_span"),s.classList.add("dark"),s.textContent=" deshacer";const d=document.createElement("P");d.classList.add("form_text"),d.textContent="una vez confirmado, el cambio no se puede",d.appendChild(s);const c=document.createElement("BUTTON");c.textContent="Cancelar",c.setAttribute("class","boton"),c.classList.add("pad1-4");const i=document.createElement("DIV");i.classList.add("buttons_container"),i.appendChild(c),i.appendChild(e);const r=document.createElement("FORM");r.setAttribute("method","POST"),r.setAttribute("action",n),r.classList.add("form"),r.classList.add("form_poupup"),r.classList.add("delete"),r.appendChild(a),r.appendChild(o),r.appendChild(d),r.appendChild(t),r.appendChild(i);const l=document.createElement("DIV");return l.setAttribute("class","section-popup"),l.appendChild(r),c.addEventListener("click",t=>{t.preventDefault(),nodo=l.parentNode.removeChild(l)}),l}function eliminarUsuario(t,e){const n=parseInt(t.getAttribute("data-id"));return e.setAttribute("value",n),"/api/eliminar/usuario"}function eliminarProducto(t,e){const n=parseInt(t.getAttribute("data-id"));return e.setAttribute("value",n),"/api/eliminar/producto"}function eliminarCliente(t,e){const n=parseInt(t.getAttribute("data-id"));return e.setAttribute("value",n),"/api/eliminar/cliente"}function eliminarCategoria(t,e){const n=parseInt(t.getAttribute("data-id"));return e.setAttribute("value",n),"/api/eliminar/categoria"}const busquedas={productos:[]};function autocompletar(){const t=document.getElementById("fac_campo_buscar"),e=(document.getElementById("buscar_prod"),document.getElementById("lista"));t.addEventListener("keyup",n=>{if(n.preventDefault(),""!=t.value){e.style.display="block";const n=t.value;let a="http://localhost:3000/api/productos/buscar",o=new FormData;o.append("fac_campo_buscar",n),fetch(a,{method:"POST",body:o,mode:"cors"}).then(t=>t.json()).then(t=>mostrarProductosBuscados(t)).catch(t=>console.log(t))}else e.style.display="none"})}function mostrarProductosBuscados(t){if(t.length>0){let e=[];document.getElementById("lista");t.forEach(t=>{const{prod_id:n,prod_sku:a,prod_nombre:o,prod_precio_unitario:s,prod_existencias:d}=t;if(e=[],!e[a]){const t=document.createElement("li");t.classList.add("lista_item"),t.textContent=`${a} - ${o}`,t.dataset.prod_id=n,t.addEventListener("click",()=>{console.log("Seleccionad: "+n)}),e.prod_sku=a}})}}function seleccionarProducto(t){document.getElementById("lista");const{prod_id:e}=t,{productos:n}=busquedas;n.some(t=>t.prod_id===e)||(busquedas.productos=[...n,t])}const crearAlerta=()=>{const t=createForm();document.querySelector("body").appendChild(t)},createAlertForm=()=>{const t=document.createElement("IMG");t.classList.add("form_image"),t.setAttribute("src","/build/img/message-solid.svg");const e=document.createElement("H2");e.classList.add("form_title"),e.textContent="¿Estas seguro?";const n=document.createElement("SPAN");n.classList.add("form_span"),n.classList.add("dark"),n.textContent=" deshacer";const a=document.createElement("P");a.classList.add("form_text"),a.textContent="una vez confirmado, el cambio no se puede";const o=document.createElement("BUTTON");o.textContent="Regresar",o.setAttribute("class","boton"),o.classList.add("pad1-4");const s=document.createElement("DIV");s.classList.add("form"),s.classList.add("form_poupup"),s.classList.add("delete"),s.appendChild(t),s.appendChild(e),s.appendChild(a),s.appendChild(o);const d=document.createElement("DIV");return d.setAttribute("class","section-popup"),d.appendChild(s),d};